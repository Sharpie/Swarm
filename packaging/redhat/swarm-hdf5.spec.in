Summary: Toolkit for agent-based simulation with hdf5 enabled.
Name: swarm-hdf5
Version: @version@
Release: @release@
Copyright: @copyright@
Group: Development/Libraries
Source: @ftproot@/swarm-@date_version@.tar.gz 
%define prefix      /usr
Prefix: %prefix
BuildRoot: /tmp/swarm-root
#BuildPrereq: hdf5 >= @hdf5_version@
BuildPrereq: hdf5
%ifarch ppc
BuildPrereq: libffi >= 1.20
%endif
BuildPrereq: kaffe
BuildPrereq: jikes
Icon: swarm.xpm
Packager: @packager@
Distribution: @distribution@
Vendor: @vendor@
URL: @url@
Requires: @base_requires@
%ifarch ppc
Requires: libffi >= 1.20
%endif
Provides: swarm-base
Requires: hdf5 >= @hdf5_version@
Conflicts: swarm
%define date_version @date_version@
 
%description
Swarm is a simulation toolkit for Complex Adaptive Systems. The Swarm
project is sponsored by the Santa Fe Institute.  To use this version,
you need a number of libraries and utilities, including tcl/tk 8.0.4
or better, and the blt library package.  This version enables hdf5.

@macros@

%changelog
* Mon Feb 28 2000 Marcus G. Daniels <mgd@swarm.org>

- Remove ppc patch.

- Remove versioning on kaffe and jikes BuildPrereq.

- Break out system-specific build rules in to separate file, swarm.rules.

- Add support for Sparc and SUSE/i386.

- Hardwire /packages/bin/gcc as compiler.

- Minimize use of %defines (using substitutions instead).

* Fri Oct 22 1999 Alex Lancaster <alex@santafe.edu>

- Replace $RPM_PACKAGE_VERSION with %{version} throughout.

- Add "%gcc_path" macro so that path to gcc can be overriden (by
  setting "%_gcc_path" in the ~/.rpmmacros file), so that packages can
  be easily built against non-stock Red Hat 6.{1,2} compilers (such as
  gcc-2.95.1).

* Tue Oct 19 1999 Alex Lancaster <alex@santafe.edu>

- Add XFree86-devel and egcs to Requires.

* Fri Oct 01 1999 Alex Lancaster <alex@santafe.edu>

- Use new common configure macros.  Enable macros for variant-ppc
  build/install requirements as per swarm.spec.

* Tue Sep 28 1999 Alex Lancaster <alex@santafe.edu>

- Rework spec file macros more consistently.

- Add jikes and kaffe as BuildPrereq, previously missing.

* Sun Sep 19 1999 Alex Lancaster <alex@santafe.edu>

- Split swarm and swarm-hdf5 files into separate spec files.  No
  way to make two slightly different builds with overlapping namespace
  in the BuildRoot using rpm, as yet.

%prep 
%setup -n swarm-%date_version

%build

%makebuilddir =with-hdf

%define configure %baseconfigure

@rules@

%gen_shared_filelist %{prefix} %{SWARM_SRC_DIR}/with-hdf

cd =with-hdf
%{gcc_path} make prefix=$RPM_BUILD_ROOT%{prefix} JAVAC=/usr/bin/jikes install

%post 
%define hdf5pathfiles etc/swarm/* lib/swarm/lib*.la
%fix_path %hdf5pathfiles

%files -f with-hdf 
%defattr(-,root,root)

%clean 
rm -rf $RPM_BUILD_ROOT

# Local variables:
# mode: shell-script
# sh-shell: rpm
# end:
