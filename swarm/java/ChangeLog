1999-03-19  Vladimir Jojic  <vjojic@wupatki.santafe.edu>

	* java-stub.el (java-print-class-phase): Make all classes
	public.

1999-03-18  Marcus G. Daniels  <mgd@pojoaque.santafe.edu>

	* java-stub.el (expanded-method-list): Renamed from method-list.
	(java-print-class-methods-in-phase, java-print-native-class): 
	Accommodate.
	(java-print-native-method): Use JSWITCHUPDATE / JINSTANTIATE of
	user-phase class for createEnd.

	* javaswarm: Print out LD_LIBRARY_PATH additions if there are no
	arguments (otherwise export and run java).

1999-03-17  Marcus G. Daniels  <mgd@pojoaque.santafe.edu>

	* javaswarm: Use \012 instead of \n to avoid problems with ucb tr.

	* java-stub.el (java-print-native-class): Use method-list instead
	of protocol-method-list.

1999-03-16  Marcus G. Daniels  <mgd@pojoaque.santafe.edu>

	* Makefile.am (C_EXTRA_DIST): Add JavaProxy and SwarmEnvironment.
	
	* javaswarm: New file.

	* Makefile.am (bin_SCRIPTS): Install it.

	* java-stub.el (java-print-method-invocation): New function.
	(java-print-native-method): Use it.  Handle +createBegin: and
	-createEnd.

1999-03-11  Marcus G. Daniels  <mgd@pojoaque.santafe.edu>

	* java-stub.el (java-print-method, java-print-native-method):
	Print "$" between method keys (instead of mixing case).
	(java-argument-print-conversion): Handle selectors. 
	(*removed-methods*): Remove the parameter SEL exceptions.
	(java-print-native-class): Don't declare jniEnv extern.
	(java-print-native-method, java-argument-print-conversion): Refer
	to env stub parameter, not jniEnv extern.

	* Makefile.am (SWARM_EXTRA_DIST): Add swarm/Selector.java.

1999-03-09  Marcus G. Daniels  <mgd@pojoaque.santafe.edu>

	* java-stub.el (*objc-to-java-type-alist*): Convert timeval_t and
	size_t to long and Color to byte.
	(*removed-protocols*, *removed-methods*): New lists.
	(method-ellipsis-p): New function.
	(removed-method-p): Use it and *removed-methods*.
	(removed-protocol-p): New function.
	(included-protocol-list): Use it instead of just
	the-CREATABLE-protocol-p.
	(java-type-to-native-type): Handle java.lang.reflect.Method.
	(java-argument-print-conversion): Handle jmethodID.
	(java-print-makefiles, java-print-classes): Use removed-protocol-p
	instead of the-CREATABLE-protocol-p.

1999-03-08  Marcus G. Daniels  <mgd@pojoaque.santafe.edu>

	* Makefile.am (C_EXTRA_DIST, SWARM_EXTRA_DIST): New variables.
	(EXTRA_DIST): Include them.

	* java-stub.el (java-type-to-native-type): Add boolean and void.
	(java-argument-print-conversion): New function.
	(java-print-native-method): Make the call. Handle argument and
	return value conversions for String and Object.
	(java-print-native-class): Include the module's header file and
	directory.h.  Declare JNIEnv object.

1999-03-05  Marcus G. Daniels  <mgd@pojoaque.santafe.edu>

	* Makefile.am (jdkdir, JAVASTUBS): Substitute.
	(all, install): Depend on computed variable name based on
	JAVASTUBS.
	(all-stubs, install-stubs): Formerly the all and install targets.

1999-03-02  Marcus G. Daniels  <mgd@pojoaque.santafe.edu>

	* java-stub.el (java-print-native-method): Print out some return
	values to avoid compiler warnings [temporary].
	(included-method-p): New function.
	(method-list, java-print-interface-methods-in-phase,
	java-print-native-class): Use included-method-p.
	(java-print-native-class): Import defobj.h.

1999-03-01  Marcus G. Daniels  <mgd@pojoaque.santafe.edu>

	* Makefile.am (SUBMAKEFILES): Use instead of MAKEFILES.  (MAKEFILES
	is the environmental equivalent of include!)
	(install): New target.

	* java-stub.el (java-print-native-method): Take phase argument.
	(java-print-native-class): Loop over creating and using phase,
	passing to java-print-native-method.
	(with-protocol-c-file): Use .m files.

1999-02-28  Marcus G. Daniels  <mgd@pojoaque.santafe.edu>

	* Makefile.am (all, stubs): Mark as phony.
	(stubs): Depend on Makefile.conf and $(MAKEFILES).
	(all): Depend on stubs.
	(Makefile.common $(MAKEFILES)): Depend on java-stub.elc
	and module headers.

	* java-stub.el (*java-path*, *c-path*): New constants.
	(with-protocol-c-file): Use *c-path*.
	(*stub-directory*): Remove.
	(module-path): Don't use *stub-directory*.
	(java-print-makefiles): Simplify to use templates.  Generate
	only Makefile.common with protocol and module lists, and
	per-module Makefiles.
	(java-print-classes): Use *java-path* instead of literal.

	* Makefile.am (stubs): Run stub generation in c and swarm
	directories.

1999-02-27  Marcus G. Daniels  <mgd@pojoaque.santafe.edu>

	* java-stub.el (removed-method-p): Avoid all methods with an
	ellipsis argument.
	(java-print-methods-in-phase): Remove.
	(java-print-interface-methods-in-phase): Loop over protocol
	methods.
	(java-print-class-methods-in-phase): Loop over expanded list of
	methods.
	(*objc-to-java-type-alist*): Treat void*, ref_t, val_t, Protocol*,
	and unsigned long long int as freaky.
	(java-objc-to-java-type): Renamed from java-type-for-objc-type.
	(with-protocol-java-file): Renamed from with-protocol-file.
	(with-protocol-c-file): New macro.
	(mangle-signature, java-type-to-signature,
	java-type-to-native-type, java-argument-convert,
	java-argument-empty-p, java-print-native-method,
	java-print-native-class): New functions.
	(java-print-classes): Call java-print-native-class.
	(java-run-all): Pass :uniquify-method-lists t.
	(module-path): New function.
	(with-protocol-{c,java}-file): Use it.
	(java-print-interface-name): Removed.
	(java-class-name, java-interface-name): New functions.  Latter
	uses former.
	(java-print-makefiles): New function.
	(java-print-classes): Use it.

1999-02-26  Marcus G. Daniels  <mgd@pojoaque.santafe.edu>

	* java-stub.el: Use insert throughout instead of java-print wrapper.
	(ensure-directory): New function.
	(with-protocol-file, java-print-interface-phase-to-file): Use it.
	(java-print-class-phase-to-file): Use it.
	(java-print-classes): Create swarm directory.
	(the-CREATABLE-protocol-p): New function.
	(CREATABLE-p): Use it.
	(removed-method-p): New function.
	(method-list): New function.  Use it.
	(java-print-methods-in-phase): Use it.
	(*objc-to-java-type-alist*): notify_t and long doubles are freaky.
	(java-print-method): Concatenate method keys together into single
	Java method name. Upcase second and after keys.
	(removed-method-p): Also reject getDisplayName, setDisplayName,
	getTypeName, copy, and remove.
	(method-list): Use expanded method list.
	(java-print-argument): Avoid use of "class" as a variable name.
	(freaky-message): New function.
	(java-type-for-objc-type): Use it.
	(java-print-classes): Don't print stubs for CREATABLE protocol.

1999-02-25  Marcus G. Daniels  <mgd@pojoaque.santafe.edu>

	* java-stub.el: Rewrite.  Stubs mostly compile now.  Two
	significant conceptual change: interfaces are generated
	for all phases of classes (prefixed with i_), and abstract
	classes are generated for when a protocol is not tagged CREATABLE.

1999-02-24  Marcus G. Daniels  <mgd@pojoaque.santafe.edu>

	* java-stub.el: Use eval-and-compile to set load-path from
	BUILDDIR.  require protocol instead of loading it.

1999-02-24  Vladimir Jojic  <vjojic@chama.santafe.edu>

	* java-stub-new.el: New java stub generator. 
	(java-make-interface): Convert module symbol to string.
	(java-make-interface-setting): Likewise.
	(java-make-class): Likewise.

1999-02-23  Marcus G. Daniels  <mgd@pojoaque.santafe.edu>

	* java-stub.el: Load protocol.el from $SWARMSRCDIR/etc/protocol.el.
	Remove buffer arguments throughout, depending instead on
	use of with-temp-file, etc.  Use java-print throughout instead of
	print and princ.
	(java-protocol-creatable-p): Renamed from java-is-creatable.
	(*objc-to-java-type-alist*): Regular express alist of type
	conversion rules.
	(*last-protocol*, *stub-directory*): New variables.
	(java-type-for-objc-type): Use it.  Use string-match using alist
	patterns as ^$ wrappedregular expressions.
	(java-protocol-creatable-p): Use find instead of loop.
	(java-print, freakyp): New functions.
	(java-print-type): Print a message when freaky types are seen.
	(java-print-argument): Don't do anything when varname doesn't
	exist (the case of method with no arguments).
	(java-print-methods-in-protocol): Use mapcar instead of loop, set
	(java-print-class): Use with-current-buffer instead of creating
	and passing down Makefile buffer to java-print-makefile.
	(java-print-classes): Kill the makefile-buffer when finished.
	Set *last-protocol* for use by debugging messages.
	(java-print-protocol-list-with-suffix): Remove (similiar contents
	were inlined in java-print-implemented-protocols-list -- now are
	in flet).
	(java-print-implemented-protocols-list): New internal function
	protocol-loop, reused several times.
	(stub-protocol-path): New function.
	(java-print-interface, java-print-interface-setting,
	java-print-class-creating, java-print-class-using): Use it.  Use
	with-temp-file instead of creating buffer by hand and passing it
	down.

1999-02-16  Vladimir Jojic  <vjojic@chama.santafe.edu>

	* java-stub.el: Makefile generation. 

	* Makefile.am (EXTRA_DIST): Add java-stub.el.

	* java-stub.el: New file.

