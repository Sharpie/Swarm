jdkdir=@jdkdir@
jdkbindir=$(jdkdir)/bin
JAVAC=$(jdkbindir)/javac

CLASSPHASES := __c U
PHASES := $(CLASSPHASES) S

INTERFACES := $(subst __c,,$(foreach sfx,$(PHASES),$(addsuffix $(sfx),$(addprefix i_,$($(module)PROTOCOLS)))))

CLASSES := $(subst __c,,$(foreach sfx,$(CLASSPHASES),$(addsuffix $(sfx),$($(module)PROTOCOLS))))

CLASSFILES = $(addsuffix .class,$(CLASSES)) $(addsuffix .class,$(INTERFACES))

all: $(CLASSFILES)

$(CLASSFILES): $(addsuffix .java,$(CLASSES)) $(addsuffix .java,$(INTERFACES))
	JAVA_HOME=$(jdkdir) $(JAVAC) -classpath ../..:$(jdkdir)/lib/classes.zip $^

