jdkdir=@jdkdir@
jdkbindir=$(jdkdir)/bin
JAVAC=$(jdkbindir)/javac
JAVA=@JAVA@
JAVACLASSES=@JAVACLASSES@
JAVA_HOME=@JAVA_HOME@
JAVACOMPILE=JAVA_HOME=$(JAVA_HOME) $(JAVAC) -classpath ../..:$(JAVACLASSES)
top_srcdir=@top_srcdir@

CLASSPHASES := __c U
PHASES := $(CLASSPHASES) S

INTERFACES := $(subst __c,,$(foreach sfx,$(PHASES),$(addsuffix $(sfx),$(addprefix i_,$($(module)PROTOCOLS)))))

_CLASSES := $(subst __c,,$(foreach sfx,$(CLASSPHASES),$(addsuffix $(sfx),$($(module)PROTOCOLS))))

JAVAFILES = $(addsuffix .java,$(_CLASSES)) $(addsuffix .java,$(INTERFACES))

-include .deps

all: $(CLASSES)

.deps: $(JAVAFILES)
	$(JAVA) -classpath $(top_srcdir)/java/jdeps.jar:$(JAVACLASSES) smr.JavaDeps.JavaDeps $(JAVAFILES) > .deps

